<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Academia de Trompeta</title>
    <link rel="stylesheet" href="css/estilo.css">
</head>
<body class="login-body">
    <div style="position: fixed; top: 10px; right: 10px; font-size: 0.6rem; color: #444;">v1.0.2</div>

    <div class="login-container">
        <h1 style="color: #e63946; margin-bottom: 5px;">游꿬 ACADEMIA</h1>
        <p style="color: #888; margin-bottom: 25px; font-size: 0.9rem;">Acceso exclusivo para alumnos</p>

        <div class="login-box">
            <input type="email" id="email" placeholder="Correo electr칩nico">
            <input type="password" id="password" placeholder="Tu contrase침a">
            <button id="btnLogin">ENTRAR AL SISTEMA</button>
            <div id="error-msg" style="color: #e63946; font-size: 0.8rem; margin-top: 15px; display: none;">
                Credenciales incorrectas
            </div>
        </div>
    </div>

    <script type="module">
        import { auth } from "./firebase.js";
        import { signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        const btnLogin = document.getElementById("btnLogin");
        const errorMsg = document.getElementById("error-msg");

        // 1. SI YA EST츼 LOGUEADO, ENVIAR AL NUEVO HOME DIRECTAMENTE
        onAuthStateChanged(auth, (user) => {
            if (user) {
                window.location.replace("home.html"); 
            }
        });

        // 2. L칍GICA DE LOGIN
        btnLogin.onclick = async () => {
            const email = document.getElementById("email").value;
            const pass = document.getElementById("password").value;

            btnLogin.innerText = "VERIFICANDO...";
            errorMsg.style.display = "none";

            try {
                await signInWithEmailAndPassword(auth, email, pass);
                // El onAuthStateChanged se encargar치 de la redirecci칩n
            } catch (error) {
                btnLogin.innerText = "ENTRAR AL SISTEMA";
                errorMsg.style.display = "block";
                console.error("Error de login:", error.message);
            }
        };
    </script>
</body>
</html>